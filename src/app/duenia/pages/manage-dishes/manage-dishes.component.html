

<side-bar></side-bar>
<!-- <main-menu></main-menu> -->
<div class="card flex justify-content-center">

  <p-dialog header="Agregar Platillo" [(visible)]="visible" [style]="{width: '450px'}" [modal]="true" class="p-fluid">
    <!-- Modal Agregar Platillo -->
    <form (ngSubmit)="agregarPlatillo()">
      <label for="nombre">Nombre del plato:</label>
      <input pInputText  required autofocus type="text" id="nombrePlatillo" [(ngModel)]="miPlatillo.nombre" name="nombre" >

    <div class="field">
      <label class="mb-3">Categoria</label>
      <div class="formgrid grid">
          <div class="field-radiobutton col-6">
              <p-radioButton id="categoriaID" name="id" value="1" [(ngModel)]="miPlatillo.categoria.id" required></p-radioButton>
              <label for="category1">Mariscos</label>
          </div>
          <div class="field-radiobutton col-6">
              <p-radioButton id="categoriaID" name="id" value="2" [(ngModel)]="miPlatillo.categoria.id" required></p-radioButton>
              <label for="category2">Jaleas</label>
          </div>
          <div class="field-radiobutton col-6">
              <p-radioButton id="categoriaID" name="id" value="3" [(ngModel)]="miPlatillo.categoria.id" required></p-radioButton>
              <label for="category3">Sopas</label>
          </div>

      </div>
  </div>
      <button pButton pRipple type="submit" label="Agregar Plato" class="p-button-raised p-button-success"></button>
    </form>
  </p-dialog>
</div>

<div class="grid" >
  <div class="col-12" >
      <div class="card px-6 py-6">
          <p-toast></p-toast>
          <p-toolbar styleClass="mb-4" >
              <ng-template pTemplate="left">
                  <h1 style="color: black;">Gestionar Platillos</h1>
              </ng-template>
          </p-toolbar>
          <!-- Boton Nuevo -->
            <button  (click)="showDialog()" pButton pRipple label="Agregar Platillo" class="p-button-success" style="width: 140px; margin-bottom: 30px;"></button>

        <!-- Tabla de patillos registrados -->
          <p-table  #dt [value]="platillos" [columns]="cols" responsiveLayout="scroll" [rows]="10" [globalFilterFields]="['name','country.name','representative.name','status']" [paginator]="true" [rowsPerPageOptions]="[10,20,30]" [showCurrentPageReport]="true" selectionMode="multiple" [rowHover]="true" dataKey="id">
              <ng-template pTemplate="caption">
                  <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
                      <h5 class="m-0">Platillos</h5>
                  </div>
              </ng-template>
              <ng-template pTemplate="header">
                  <tr>
                      <th>Nombre <p-sortIcon field="name"></p-sortIcon></th>
                      <th>Categoria <p-sortIcon field="category"></p-sortIcon></th>
                      <th>Acciones<p-sortIcon field="category"></p-sortIcon></th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-platillo>
                  <tr>
                      <td >
                          <span class="p-column-title">Name</span>
                          {{ platillo.nombre }}
                      </td>
                     <td >
                          <span class="p-column-title">Category</span>
                          {{platillo.categoria.nombre}}
                      </td>
                      <td>
                          <div class="flex">
                              <button pButton pRipple type="button" icon="pi pi-pencil" class="p-button-rounded p-button-info mr-2"(click)="cargarPlatillo(platillo)"></button>
                              <button pButton pRipple type="button" icon="pi pi-trash" class="p-button-rounded p-button-danger"(click)="cargarIDBorrar(platillo)"></button>
                          </div>
                      </td>
                  </tr>
              </ng-template>
          </p-table>
      </div>

      <!-- Modal Editar Platillo -->
      <p-dialog [(visible)]="productDialog" [style]="{width: '450px'}" header="Editar Platillo" [modal]="true" class="p-fluid">
          <ng-template pTemplate="content">

            <div class="field">
              <label for="name">Name</label>
              <input type="text" pInputText id="name" [(ngModel)]="loadPlatillo.nombre" required autofocus [ngClass]="{'ng-invalid ng-dirty' : submitted && !selectedPlato.nombre}" name="
              nombre"/>
              <small class="ng-dirty ng-invalid" *ngIf="!loadPlatillo.nombre">Name is required.</small>
          </div>



          <div class="field">
              <label class="mb-3">Categoria</label>
              <div class="formgrid grid">
                  <div class="field-radiobutton col-6">
                      <p-radioButton id="category1" name="category" value="1" [(ngModel)]="loadPlatillo.categoria.id"></p-radioButton>
                      <label for="category1">Mariscos</label>
                  </div>
                  <div class="field-radiobutton col-6">
                      <p-radioButton id="category2" name="category" value="2" [(ngModel)]="loadPlatillo.categoria.id"></p-radioButton>
                      <label for="category2">Jaleas</label>
                  </div>
                  <div class="field-radiobutton col-6">
                      <p-radioButton id="category3" name="category" value="3" [(ngModel)]="loadPlatillo.categoria.id"></p-radioButton>
                      <label for="category3">Sopas</label>
                  </div>
              </div>
          </div>
          </ng-template>


          <ng-template pTemplate="footer">
            <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-text" (click)="this.productDialog =false"></button>
            <button pButton pRipple label="Guardar" icon="pi pi-check" class="p-button-text" (click)="actualizarPlatillo(loadPlatillo)"></button>
        </ng-template>
      </p-dialog>

       <!-- Modal Eliminar Platillo -->
       <p-dialog [(visible)]="deleteProductDialog" header="Eliminar PLatillo" [modal]="true" [style]="{width:'450px'}">
        <div class="flex align-items-center justify-content-center">
            <i class="pi pi-exclamation-triangle mr-3" style="font-size: 2rem"></i>
            <span *ngIf="selectedPlato1">Estas seguro de eliminar el platillo <b>{{loadDeletePlatillo.nombre}}</b>?</span>
        </div>
        <ng-template pTemplate="footer">
            <button pButton pRipple icon="pi pi-times" class="p-button-text" label="No" (click)="deleteProductDialog = false"></button>
            <button pButton pRipple icon="pi pi-check" class="p-button-text" label="Si" (click)="eliminarPLatillo(loadDeletePlatillo)"></button>
        </ng-template>
    </p-dialog>
  </div>


</div>

<div class="overlay" *ngIf="loading">
    <div class="loader"></div>
  </div>





